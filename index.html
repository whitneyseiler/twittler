<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="jquery.min.js" type="text/javascript"></script>
    <script src="jquery.timeago.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Twittler</title>
  </head>

  <body>
    <header>
      <nav>
        <ul id="topnav">
          <li><a class="nav-link" href="index.html">Home</a></li>
          <li><a class="logo"><img width=20px padding=10px  src="https://image.flaticon.com/icons/svg/174/174876.svg"></a></li>
          <li style="float:right"><a class="nav-link" href="#search">Search</a></li>
          <li style="float:right"><a class="nav-link" href="#tweet">Tweet</a></li>
          <li style="float:right"><a class="nav-link" href="#profile">Profile</a></li>
        </ul>
      </nav>
    </header>

    <div id="main">
      <!-- <div id="sidebar">
        <p>This is a sidebar</p>
      </div> -->
    <div id="timeline">
        <h2>Feed</h2>
        <button class="refresh">See New Tweets</button>
        <div id="tweet-container">
          <script>
          $(document).ready(function() {
            var $tweetBody = $('#tweet-container');
            streams.lastRead = 0;
            var updateTweets = function() {
              var index = streams.lastRead;
              streams.lastRead = streams.home.length;
              while (index < streams.home.length) {
                var tweet = streams.home[index];
                var $tweet = $('<div></div>');
                if (tweet !== undefined) {
                  $tweet.text('@' + tweet.user + ': ' + tweet.message);
                  $tweetBody.prepend($tweet);
                  index += 1;
                }
              }
              //setTimeout(updateTweets, 5000);
            }
            updateTweets();
            //Event listeners
            $('.refresh').on('click', function() {
              updateTweets();
            });
            $('.user').on('click', function() {
              var name = $(this).text();
              $tweetBody.html('');
              for (var i = 0; i < streams.home.length; i++) {
                var tweet = streams.home[i];
                if (tweet.user === name) {
                  var $tweet = $('<div></div>');
                  $tweet.text('[' + tweet.created_at + '] @' + tweet.user + ': ' + tweet.message);
                  $tweetBody.prepend($tweet);
                }
              }
            });
            $('.home').on('click', function() {
              $tweetBody.html('');
              streams.lastRead = 0;
              updateTweets();
            });
          });
          </script>
        </div>
      </div>
    </div>

  </body>
</html>
